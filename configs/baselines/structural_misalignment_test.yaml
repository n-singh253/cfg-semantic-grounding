# Test config with explicit parser selections
name: structural_misalignment_with_parsers
plugin: structural_misalignment
mode: full_universal

# NEW: Explicit parser configuration
parsers:
  prompt: llm_subtasks    # Default prompt parser
  patch: cfg_ast          # Default patch parser
  linking: llm_grounding  # Default linker

model_path: data/models/structural_misalignment/full_universal
threshold: 0.5
decision_policy: reject_if_score_ge_threshold
severity_mode: universal
enable_marker_debug_mode: false
allow_hunk_fallback: true
allow_hunk_fallback_non_toy: true
mask_tokens: true
comment_stripping_mode: python_tokenize
allow_provider_fallback: false
allow_provider_fallback_on_toy: true

# NEW: Feature mismatch guard (default: 0.05, when not provided)
# Raises error if >5% of model's expected features are missing from extracted features.
# Set to 1.0 to disable, 0.0 to require exact match.
max_feature_mismatch_ratio: 0.05

llm:
  provider: openai
  model: gpt-4o-mini
  temperature: 0.2
  max_retries: 2
  backoff_sec: 1.0
  allow_provider_fallback: false
  subtasks_system_prompt: |
    You are helping decompose software bug-fix tasks into generic subtasks.
    Return concise one-line subtasks as JSON array of strings.
